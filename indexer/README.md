# Indexer Module - Tiny Search Engine (TSE)

Manzi Fabrice Niyigaba
COSC 50, Fall 2024

---

## Overview

The `indexer` module is part of the Tiny Search Engine (TSE) project, which is designed to support efficient document retrieval by creating an index of words found within crawled web pages. This module builds an index mapping words to their occurrences in specific documents and saves this data in a file for later search queries.

The `indexer` depends on data generated by the `crawler` module, which gathers pages from the web and stores them in a specified directory. The `indexer` reads these files and constructs an in-memory index of words and their respective locations, with document IDs and occurrence counts. 

## Components

The `indexer` module consists of the following key components:

### 1. `indexer.c`
The main program file for the `indexer`. It performs the following steps:
- **Argument Parsing**: Verifies that the program is called with the correct arguments.
- **Directory Validation**: Checks that the specified page directory was created by the `crawler`.
- **Index Creation**: Initializes a new hashtable-based index and builds it by reading pages from the specified directory.
- **Index Storage**: Saves the completed index to a specified output file.

Inside `indexer.c`, the following primary functions are used:
- **`index_build`**: Iterates through each document in the page directory, loading each webpage and passing it to the `indexPage` function.
- **`indexPage`**: Processes a webpage, extracting and normalizing each word, and updating the in-memory index to include each word and its count for the given document ID.

### 2. `testing.sh`
The `testing.sh` script automates testing for the `indexer` module. It:
- **Tests Valid and Invalid Inputs**: Runs a series of fuzz tests to simulate various valid and invalid inputs. These tests include:
  - Missing or extra arguments
  - Non-existent or read-only directories
  - Valid page directories generated by the crawler

The `testing.sh` script outputs results in two files:
- **`testing.out`**: Contains output from invalid and edge-case tests to confirm the `indexer` correctly handles errors. This file is committed to the repository for convenience and reference.
- **`indexer.out`**: Stores the final index output from a successful indexing run, showing each word, document IDs, and occurrence counts.If the user wishes to convert these output the txt instead out they should change the followind testing.sh's line 
```bash
cat ../data/letters.index > indexer.out
```
into 
```bash
cat ../data/letters.index > indexer.txt
```
## Usage

### Running the Indexer
To run the `indexer`, execute the following command:

```bash
./indexer pageDirectory indexFilename
```

Where:
- `pageDirectory` is the directory containing crawled pages (generated by the `crawler`).
- `indexFilename` is the output file where the index data will be saved.

### Running Tests
To perform the testing, execute:

```bash
make test
```

This will run `testing.sh`, which performs a variety of tests and generates `testing.out` for invalid input results and `indexer.out` for the actual indexing output.

---

### Note
For a detailed breakdown of each function within `indexer.c`, `pagedir.c`, and `word.c`, refer to their respective header files: `indexer.h`, `pagedir.h`, and `word.h`. These headers contain function descriptions and usage notes. 

--- 
